        SELECT d.max, d.avg, d.min, d.max_time, d.min_time,
        n.ip, COALESCE(n.cluster,d.cluster) as cluster, COALESCE(n.hostname,d.hostname) as hostname, n.power, n.cpu,
        n.cpu_num, n.cpu_slot_num, n.mem, n.net_num, n.product_name,
        n.product_serial, n.bios_version, n.system_type, n.system_version, n.is_delete, n.deleted, n.created,
        n.updated, COALESCE(n.reportdate,d.reportdate) as reportdate, n.createTime, n.updateTime, d.cloud_uuid
        from
        (	select * from oms_report_node_cpu_${zq} where reportdate &gt;= '${starReportDate}' AND reportdate &lt;= '${endReportDate}'
        AND cluster = '${cluster}' and cloud_uuid='${cloudUuid}'
        ) d
        full join
        (select * from (
        select *, row_number() over(PARTITION by cluster,hostname order by updated desc) as cnt from oms_node_${zq}
        ) v1 where v1.cnt=1 and v1.reportdate &gt;= '${starReportDate}' AND v1.reportdate &lt;= '${endReportDate}' and v1.is_delete='false'
          AND v1.cluster = '${cluster}' and v1.cloud_uuid='${cloudUuid}'
        ) n
        on  d.hostname=n.hostname and d.cluster=n.cluster and d.cloud_uuid=n.cloud_uuid